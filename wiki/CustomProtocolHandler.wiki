#summary The xmldb:exist:// custom protocol handler.
#labels Featured,Phase-Implementation

== Custom protocol handler "xmldb:exist://" ==

Under certain conditions it is handy to be able to access data stored in eXist via a *xmldb:exist://* type URL, straight out of javacode. The code below shows how to do this.

[http://www.exist-db.org/ http://www.exist-db.org/logo.jpg]

To be able to use this special URL you can either
 * set the value 'org.exist.protocols' to (java) system property 'java.protocol.handler.pkgs'
 * call URL.setURLStreamHandlerFactory(new eXistURLStreamHandlerFactory());

 A code example for use in a Java program:
{{{
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.MalformedURLException;
import java.net.URL;
import org.exist.protocols.eXistURLStreamHandlerFactory;

...

// ************************
// Setup protocol handler

BasicConfigurator.configure();

// OR use this
System.setProperty( 'java.protocol.handler.pkgs', 'org.exist.protocolhandler.protocols' );

// OR use this
URL.setURLStreamHandlerFactory(new eXistURLStreamHandlerFactory());

URL url = new URL('xmldb:exist://guest:guest@localhost:8080/exist/xmlrpc/db/shakespeare/plays/macbeth.xml');


// ************************
// Read from URL
 
// InputStream os = url.openConnection().getInputStream ();
InputStream is = url.openStream();
            
... (handle inputstream) ...
            
is.close();

// ************************
// Write to URL
OutputStream os = url.openConnection().getOutputStream();

}}}

== Dependancies ==
The code does have a dependancy with the eXist jar files, in particular:
 * exist.jar
 * exist-optional.jar (to be checked)
 * log4j-1.2.14.jar
 * xmldb.jar
 * xmlrpc-1.2-patched.jar

== Status ==
The code is fully functional for both embedded and remote URLs. It is also possible to supply username/password information to the URL. Example:

 * xmldb:exist:///db/foobar/document.xml
 * xmldb:exist://username:password@/db/foobar/document.xml
 * xmldb:exist://localhost:8080/exist/xmlrpc/db/foobar/document.xml
 * xmldb:exist://username:password@localhost:8080/exist/xmlrpc/db/foobar/document.xml

== ToDo ==
 * refactor code
 * add handling of exist instance name

== Known Issues ==
 * URL parsing is not yet perfect :-)






